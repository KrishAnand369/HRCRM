{% extends 'app/webkit/main.html' %}
{% load static %}
{% block content %}
<div class="row">
    <div class="col-sm-12">
       <div class="card">
          <div class="card-header d-flex justify-content-between">
             <div class="header-title">
                <h4 class="card-title">Pending Leave Applications</h4>
                <h4 class="card-title">{{pending_applications}}</h4>
             </div>
          </div>
          <div class="card-body">
             <div class="table-responsive">
                <table id="user-list-table" class="table table-striped dataTable mt-4 mb-2" role="grid"
                   aria-describedby="user-list-page-info">
                   <thead>
                      <tr class="ligth">
                         <th>Employee Name</th>
                         <th>Reason</th>
                         <th>Date</th>
                         <th style="min-width: 100px">Action</th>
                      </tr>
                   </thead>
                   <tbody>
                      {% for application in leave_applications %}
                      <tr>
                        <td>{{application.employee}}</td>
                        <td>{{application.reason}}</td>
                        <td>{{application.date}}</td>
                        <td>
                           <div class="flex align-items-center list-user-action">
                                 <button class="btn bg-primary" data-toggle="modal" data-target="#detailsModal{{ application.id }}" title="Details">
                                       <i class="ri-pencil-line mr-0"></i>
                                 </button>
                                 {% include 'app/webkit/Employee/leave_details_modal.html' with application=application %}
                                 <form action="{% url 'CRM:approve_leave' application.id %}" method="post" style="display: inline;" onsubmit="return confirm('Are you sure you want to approve this leave application?');">
                                    {% csrf_token %}
                                    <button type="submit" class="btn bg-success" data-toggle="tooltip" data-placement="top" title="Approve">
                                        <i class="ri-check-fill mr-0"></i>
                                    </button>
                                 </form>
                                 <form action="{% url 'CRM:decline_leave' application.id %}" method="post" style="display: inline;" onsubmit="return confirm('Are you sure you want to Reject this leave application?');">
                                    {% csrf_token %}
                                    <button type="submit" class="btn bg-danger" data-toggle="tooltip" data-placement="top" title="Reject">
                                        <i class="ri-close-line mr-0"></i>
                                    </button>
                                 </form>
                           </div>
                        </td>
                     </tr>
                     {% endfor %}
                   </tbody>
                </table>
             </div>
          </div>
       </div>
    </div>
 </div>
 {% endblock %} 